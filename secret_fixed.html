
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>RAUN - Accès sécurisé</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyD0R0IFgjCk3gWgVxK3-WnfLubhAqsKbOM",
      authDomain: "raun-network.firebaseapp.com",
      projectId: "raun-network",
      storageBucket: "raun-network.firebasestorage.app",
      messagingSenderId: "541416001018",
      appId: "1:541416001018:web:df564a55255d4615206843",
      measurementId: "G-LVV48NKDF8"
    };

    try {
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      const params = new URLSearchParams(window.location.search);
      const code = params.get('code');

      if (code) {
        document.body.innerHTML += `<p>Code détecté : ${code}</p>`;
        await addDoc(collection(db, "accessLogs"), {
          code: code,
          time: new Date(),
          userAgent: navigator.userAgent
        });
        document.body.innerHTML += `<p>✅ Code enregistré dans Firestore : ${code}</p>`;
      } else {
        document.body.innerHTML += "<p>❌ Aucun code trouvé dans l'URL.</p>";
      }
    } catch (error) {
      console.error("Erreur Firebase :", error);
      document.body.innerHTML += `<p style="color:red;">❌ Erreur Firebase : ${error.message}</p>`;
    }
  </script>
</head>
<body>
  <h1>Accès à la matrice RAUN</h1>
</body>
</html>
